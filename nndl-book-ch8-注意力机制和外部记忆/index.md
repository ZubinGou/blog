# ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹ç¬¬8ç«  - æ³¨æ„åŠ›æœºåˆ¶å’Œå¤–éƒ¨è®°å¿†


ç”¨CNNç­‰ç¼–ç ä¸€ä¸ªå‘é‡è¡¨ç¤ºæ–‡æœ¬æ‰€æœ‰ç‰¹å¾ï¼Œå­˜åœ¨ä¿¡æ¯ç“¶é¢ˆ

ç½‘ç»œå®¹é‡ï¼ˆNetwork Capacityï¼‰ï¼šå­˜å‚¨ä¿¡æ¯å—é™ä¸ç¥ç»å…ƒæ•°é‡å’Œç½‘ç»œå¤æ‚åº¦
- å¯¹äºè¿‡è½½ä¿¡æ¯ï¼šå¼•å…¥æ³¨æ„åŠ›å’Œè®°å¿†æœºåˆ¶

## 8.1 è®¤çŸ¥ç¥ç»ç§‘å­¦ä¸­çš„æ³¨æ„åŠ›
æ³¨æ„åŠ›ï¼ˆAttentionï¼‰ï¼šä»å¤§é‡ä¿¡æ¯ä¸­é€‰æ‹©å°éƒ¨åˆ†æœ‰ç”¨ä¿¡æ¯é‡ç‚¹å¤„ç†ï¼Œå¿½ç•¥å…¶ä»–ä¿¡æ¯

æ³¨æ„åŠ›åˆ†ç±»ï¼š
1. è‡ªä¸Šè€Œä¸‹çš„æœ‰æ„è¯†çš„æ³¨æ„åŠ›ï¼Œç§°ä¸ºèšç„¦å¼æ³¨æ„åŠ›ï¼ˆFocus Attentionï¼‰/ é€‰æ‹©æ€§æ³¨æ„åŠ›ï¼ˆSelective Attentionï¼‰ï¼šæœ‰é¢„å®šç›®çš„ã€ä¾èµ–ä»»åŠ¡çš„ï¼Œä¸»åŠ¨æœ‰æ„è¯†åœ°èšç„¦äºæŸä¸€å¯¹è±¡çš„æ³¨
æ„åŠ›
2. è‡ªä¸‹è€Œä¸Šçš„æ— æ„è¯†çš„æ³¨æ„åŠ›ï¼Œç§°ä¸ºåŸºäºæ˜¾è‘—æ€§çš„æ³¨æ„åŠ›ï¼ˆSaliency-Based Attentionï¼‰ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡çš„åˆºæ¿€ä¿¡æ¯ä¸åŒäºå…¶å‘¨å›´ä¿¡æ¯ï¼Œä¸€ç§æ— æ„è¯†çš„â€œèµ¢è€…é€šåƒâ€ï¼ˆWinner-Take-Allï¼‰æˆ–è€…é—¨æ§ï¼ˆGatingï¼‰æœºåˆ¶å°±å¯ä»¥æŠŠæ³¨æ„åŠ›è½¬å‘è¿™ä¸ªå¯¹è±¡


## 8.2 æ³¨æ„åŠ›æœºåˆ¶
å¯ä»¥å°†æœ€å¤§æ±‡èšï¼ˆMax Poolingï¼‰ã€é—¨æ§ï¼ˆGatingï¼‰æœºåˆ¶è¿‘ä¼¼åœ°çœ‹ä½œè‡ªä¸‹è€Œä¸Šçš„åŸºäºæ˜¾è‘—æ€§çš„æ³¨æ„åŠ›æœºåˆ¶

æ³¨æ„åŠ›æœºåˆ¶è®¡ç®—æ­¥éª¤ï¼š
1. åœ¨æ‰€æœ‰è¾“å…¥ä¿¡æ¯ä¸Šè®¡ç®—æ³¨æ„åŠ›åˆ†å¸ƒ
2. æ ¹æ®æ³¨æ„åŠ›åˆ†å¸ƒè®¡ç®—è¾“å…¥ä¿¡æ¯çš„åŠ æƒåˆ†å¸ƒ

**æ³¨æ„åŠ›åˆ†å¸ƒ**
$$
\begin{aligned}
\alpha\_{n} &=p(z=n \mid \boldsymbol{X}, \boldsymbol{q}) \\\\
&=\operatorname{softmax}\left(s\left(\boldsymbol{x}\_{n}, \boldsymbol{q}\right)\right) \\\\
&=\frac{\exp \left(s\left(\boldsymbol{x}\_{n}, \boldsymbol{q}\right)\right)}{\sum\_{j=1}^{N} \exp \left(s\left(\boldsymbol{x}\_{j}, \boldsymbol{q}\right)\right)}
\end{aligned}
$$
- æŸ¥è¯¢å‘é‡ï¼ˆQuery Vectorï¼‰$q$
- æ³¨æ„åŠ›å˜é‡$z \in[1, N]$ï¼Œè¡¨ç¤ºè¢«é€‰æ‹©ä¿¡æ¯çš„ç´¢å¼•ä½ç½®
- æ³¨æ„åŠ›åˆ†å¸ƒï¼ˆAttention Distributionï¼‰$\alpha\_{n}$
- æ³¨æ„åŠ›æ‰“åˆ†å‡½æ•°$s(\boldsymbol{x}, \boldsymbol{q})$

$$
\begin{aligned}
\text { åŠ æ€§æ¨¡å‹ } & & 
s(\boldsymbol{x}, \boldsymbol{q})&=\boldsymbol{v}^{\top} \tanh (\boldsymbol{W} \boldsymbol{x}+\boldsymbol{U} \boldsymbol{q})\\
\text { ç‚¹ç§¯æ¨¡å‹ } & & s(\boldsymbol{x}, \boldsymbol{q}) &=\boldsymbol{x}^{\top} \boldsymbol{q} \\\\
\text { ç¼©æ”¾ç‚¹ç§¯æ¨¡å‹ } & & s(\boldsymbol{x}, \boldsymbol{q}) &=\frac{\boldsymbol{x}^{\top} \boldsymbol{q}}{\sqrt{D}}, \\\\
\text { åŒçº¿æ€§æ¨¡å‹ } & & s(\boldsymbol{x}, \boldsymbol{q})&=\boldsymbol{x}^{\top} \boldsymbol{W} \boldsymbol{q},
\end{aligned}
$$

**åŠ æƒå¹³å‡**
è½¯æ€§æ³¨æ„åŠ›æœºåˆ¶ï¼ˆSoft Attention Mechanism
$$
\begin{aligned}
\operatorname{att}(\boldsymbol{X}, \boldsymbol{q}) &=\sum\_{n=1}^{N} \alpha\_{n} \boldsymbol{x}\_{n}, \\\\
&=\mathbb{E}\_{\boldsymbol{z} \sim p(z \mid \boldsymbol{X}, \boldsymbol{q})}\left[\boldsymbol{x}\_{z}\right]
\end{aligned}
$$

![692288459ef878cf2172e5a8cd155df7.png](/blog/_resources/b379b8fe2711480f8af5978078e21fec.png)

### 8.2.1 æ³¨æ„åŠ›æœºåˆ¶çš„å˜ä½“
#### ç¡¬æ€§æ³¨æ„åŠ›
åªå…³æ³¨æŸä¸€ä¸ªè¾“å…¥å‘é‡

ä¸¤ç§å®ç°æ–¹å¼ï¼š
1. æœ€å¤§é‡‡æ ·ï¼š$\operatorname{att}(\boldsymbol{X}, \boldsymbol{q})=\boldsymbol{x}\_{\hat{n}}$ï¼Œ$\hat{n}=\underset{n=1}{\arg \max } \alpha\_{n}$
2. éšæœºé‡‡æ ·ï¼ˆæ ¹æ®æ³¨æ„åŠ›åˆ†å¸ƒï¼‰

ç¡¬æ€§æ³¨æ„åŠ›ç¼ºç‚¹ï¼šæŸå¤±å‡½æ•°å’Œæ³¨æ„åŠ›åˆ†å¸ƒå‡½æ•°å…³ç³»ä¸å¯å¯¼ï¼Œæ— æ³•ç”¨BPè®­ç»ƒï¼Œé€šå¸¸é‡‡ç”¨å¼ºåŒ–å­¦ä¹ è®­ç»ƒã€‚

#### é”®å€¼å¯¹æ³¨æ„åŠ›
é”®è®¡ç®—æ³¨æ„åŠ›åˆ†å¸ƒï¼Œå€¼è®¡ç®—èšåˆä¿¡æ¯
$$
\begin{aligned}
\operatorname{att}((\boldsymbol{K}, \boldsymbol{V}), \boldsymbol{q}) &=\sum\_{n=1}^{N} \alpha\_{n} \boldsymbol{v}\_{n} \\\\
&=\sum\_{n=1}^{N} \frac{\exp \left(s\left(\boldsymbol{k}\_{n}, \boldsymbol{q}\right)\right)}{\sum\_{j} \exp \left(s\left(\boldsymbol{k}\_{j}, \boldsymbol{q}\right)\right)} \boldsymbol{v}\_{n},
\end{aligned}
$$

#### å¤šå¤´æ³¨æ„åŠ›
å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attentionï¼‰æ˜¯åˆ©ç”¨å¤šä¸ªæŸ¥è¯¢ ğ‘¸ = [ğ’’1, â‹¯ , ğ’’ğ‘€]ï¼Œæ¥å¹¶è¡Œåœ°ä»è¾“å…¥ä¿¡æ¯ä¸­é€‰å–å¤šç»„ä¿¡æ¯ï¼š

$$
\operatorname{att}((\boldsymbol{K}, \boldsymbol{V}), \boldsymbol{Q})=\operatorname{att}\left((\boldsymbol{K}, \boldsymbol{V}), \boldsymbol{q}\_{1}\right) \oplus \cdots \oplus \operatorname{att}\left((\boldsymbol{K}, \boldsymbol{V}), \boldsymbol{q}\_{M}\right)
$$

#### ç»“æ„åŒ–æ³¨æ„åŠ›
è¾“å…¥ä¿¡æ¯æœ¬èº«å…·æœ‰å±‚æ¬¡ï¼ˆHierarchicalï¼‰ç»“æ„ï¼Œæ¯”å¦‚æ–‡æœ¬å¯ä»¥åˆ†ä¸ºè¯ã€å¥å­ã€æ®µè½ã€ç¯‡ç« ç­‰ä¸åŒç²’åº¦çš„å±‚æ¬¡ã€‚

å¯ä»¥ä½¿ç”¨å±‚æ¬¡åŒ–çš„æ³¨æ„åŠ›æ¥è¿›è¡Œæ›´å¥½çš„ä¿¡æ¯é€‰æ‹© [Yang et al.,2016]

å¯ä»¥å‡è®¾æ³¨æ„åŠ›ä¸ºä¸Šä¸‹æ–‡ç›¸å…³çš„äºŒé¡¹åˆ†å¸ƒï¼Œç”¨ä¸€ç§å›¾æ¨¡å‹æ¥æ„å»ºæ›´å¤æ‚çš„ç»“æ„åŒ–æ³¨æ„åŠ›åˆ†å¸ƒ [Kim et al., 2017]

#### æŒ‡é’ˆç½‘ç»œ
æŒ‡é’ˆç½‘ç»œï¼ˆPointer Networkï¼‰[Vinyals et al., 2015]æ˜¯ä¸€ç§Seq2seqæ¨¡å‹ï¼Œè¾“å…¥$\boldsymbol{X}=\boldsymbol{x}\_{1}, \cdots, \boldsymbol{x}\_{N}$ï¼Œè¾“å‡º$\boldsymbol{c}\_{1: M}=c\_{1}, c\_{2}, \cdots, c\_{M}, c\_{m} \in[1, N], \forall m$

è¾“å‡ºä¸ºè¾“å…¥åºåˆ—çš„ä¸‹æ ‡

$$
\begin{aligned}
p\left(c\_{1: M} \mid \boldsymbol{x}\_{1: N}\right) &=\prod\_{m=1}^{M} p\left(c\_{m} \mid c\_{1:(m-1)}, \boldsymbol{x}\_{1: N}\right) \\\\
& \approx \prod\_{m=1}^{M} p\left(c\_{m} \mid \boldsymbol{x}\_{c\_{1}}, \cdots, \boldsymbol{x}\_{c\_{m-1}}, \boldsymbol{x}\_{1: N}\right),
\end{aligned}
$$

$$
p\left(c\_{m} \mid c\_{1:(m-1)}, \boldsymbol{x}\_{1: N}\right)=\operatorname{softmax}\left(s\_{m, n}\right)
$$
$$
s\_{m, n}=\boldsymbol{v}^{\top} \tanh \left(\boldsymbol{W} \boldsymbol{x}\_{n}+\boldsymbol{U} \boldsymbol{h}\_{m}\right), \forall n \in[1, N]
$$

![9b5068f5d270171849d71b4e1eee55d7.png](/blog/_resources/43a613fd332042f3a2d3be63c377a81e.png)


## 8.3 è‡ªæ³¨æ„åŠ›æ¨¡å‹
è‡ªæ³¨æ„åŠ›æ¨¡å‹ï¼ˆSelf-Attention Modelï¼‰ï¼šå³å†…éƒ¨æ³¨æ„åŠ›ï¼ˆIntra-Attentionï¼‰

è‡ªæ³¨æ„åŠ›å¯ä»¥ä½œä¸ºç¥ç»ç½‘ç»œä¸­çš„ä¸€å±‚æ¥ä½¿ç”¨ï¼Œæœ‰æ•ˆåœ°å»ºæ¨¡é•¿è·ç¦»ä¾èµ–é—®é¢˜ [Vaswani et al., 2017]

ç»å¸¸é‡‡ç”¨æŸ¥è¯¢-é”®-å€¼ï¼ˆQuery-Key-Valueï¼ŒQKVï¼‰æ¨¡å¼

![87adaecfc12645c8f7cbc44cb917b18e.png](/blog/_resources/ff0c8448082f4eaba2e4762f11527df3.png)

$$
\begin{array}{l}
\boldsymbol{Q}=\boldsymbol{W}\_{q} \boldsymbol{X} \in \mathbb{R}^{D\_{k} \times N} \\\\
\boldsymbol{K}=\boldsymbol{W}\_{k} \boldsymbol{X} \in \mathbb{R}^{D\_{k} \times N} \\\\
\boldsymbol{V}=\boldsymbol{W}\_{v} \boldsymbol{X} \in \mathbb{R}^{D\_{v} \times N}
\end{array}
$$

$$
\begin{aligned}
\boldsymbol{h}\_{n} &=\operatorname{att}\left((\boldsymbol{K}, \boldsymbol{V}), \boldsymbol{q}\_{n}\right) \\\\
&=\sum\_{j=1}^{N} \alpha\_{n j} \boldsymbol{v}\_{j} \\\\
&=\sum\_{j=1}^{N} \operatorname{softmax}\left(s\left(\boldsymbol{k}\_{j}, \boldsymbol{q}\_{n}\right)\right) \boldsymbol{v}\_{j},
\end{aligned}
$$

å¦‚ä½¿ç”¨ç¼©æ”¾ç‚¹ç§¯æ‰“åˆ†ï¼Œè¾“å‡ºå¯ä»¥ç®€å†™ä¸ºï¼š
$$
\boldsymbol{H}=\boldsymbol{V} \operatorname{softmax}\left(\frac{\boldsymbol{K}^{\top} \boldsymbol{Q}}{\sqrt{D\_{k}}}\right)
$$

![c0f955a106e62040cc66ffb13a42e1ba.png](/blog/_resources/66a6091dc1aa44d9ba9e7f9d965f6134.png)
- å®çº¿æ˜¯å¯å­¦ä¹ çš„æƒé‡
- è™šçº¿æ˜¯åŠ¨æ€ç”Ÿæˆçš„æƒé‡ï¼Œå¯ä»¥å¤„ç†å˜é•¿ä¿¡æ¯


## 8.4 äººè„‘ä¸­çš„è®°å¿†
ä¿¡æ¯ä½œä¸ºä¸€ç§æ•´ä½“æ•ˆåº”ï¼ˆCollective Effectï¼‰å­˜å‚¨åœ¨å¤§è„‘ç»„ç»‡ä¸­ï¼Œå³è®°å¿†åœ¨å¤§è„‘çš®å±‚æ˜¯åˆ†å¸ƒå¼å­˜å‚¨çš„ï¼Œè€Œä¸æ˜¯å­˜å‚¨äºæŸä¸ªå±€éƒ¨åŒºåŸŸã€‚

äººè„‘è®°å¿†å…·æœ‰å‘¨æœŸæ€§å’Œè”æƒ³æ€§

**è®°å¿†å‘¨æœŸ**
- é•¿æœŸè®°å¿†ï¼ˆLong-Term Memoryï¼‰ï¼šä¹Ÿç§°ä¸ºç»“æ„è®°å¿†æˆ–çŸ¥è¯†ï¼ˆKnowledgeï¼‰ï¼Œä½“ç°ä¸ºç¥ç»å…ƒä¹‹é—´çš„è¿æ¥å½¢æ€ï¼Œå…¶æ›´æ–°é€Ÿåº¦æ¯”è¾ƒæ…¢
	- ç±»æ¯”æƒé‡å‚æ•°
- çŸ­æœŸè®°å¿†ï¼ˆShort-Term Memoryï¼‰ï¼šä½“ç°ä¸ºç¥ç»å…ƒçš„æ´»åŠ¨ï¼Œæ›´æ–°è¾ƒå¿«ï¼Œç»´æŒæ—¶é—´ä¸ºå‡ ç§’è‡³å‡ åˆ†é’Ÿ
	- ç±»æ¯”éšçŠ¶æ€
- å·¥ä½œè®°å¿†ï¼ˆWorking Memoryï¼‰ï¼šäººè„‘çš„ç¼“å­˜ï¼ŒçŸ­æœŸè®°å¿†ä¸€èˆ¬æŒ‡è¾“å…¥ä¿¡æ¯åœ¨äººè„‘ä¸­çš„è¡¨ç¤ºå’ŒçŸ­æœŸå­˜å‚¨ï¼Œå·¥ä½œè®°å¿†æ˜¯å’Œä»»åŠ¡ç›¸å…³çš„â€œå®¹å™¨â€ã€‚å®¹é‡è¾ƒå°ï¼Œä¸€èˆ¬å¯ä»¥å®¹çº³4ç»„é¡¹ç›®ã€‚

æ¼”åŒ–ï¼ˆEvolutionï¼‰è¿‡ç¨‹ï¼šï¼çŸ­æœŸè®°å¿†ã€é•¿æœŸè®°å¿†çš„åŠ¨æ€æ›´æ–°è¿‡ç¨‹

**è”æƒ³è®°å¿†**

å¤§è„‘ä¸»è¦é€šè¿‡**è”æƒ³**è¿›è¡Œæ£€ç´¢

è”æƒ³è®°å¿†ï¼ˆAssociative Memoryï¼‰ï¼šå­¦ä¹ å’Œè®°ä½ä¸åŒå¯¹è±¡ä¹‹é—´å…³ç³»çš„èƒ½åŠ›

- åŸºäºå†…å®¹å¯»å€çš„å­˜å‚¨ï¼ˆContent-Addressable Memoryï¼ŒCAMï¼‰ï¼šè”æƒ³è®°å¿†ï¼Œé€šè¿‡å†…å®¹åŒ¹é…æ–¹æ³•è¿›è¡Œå¯»å€çš„ä¿¡æ¯å­˜å‚¨æ–¹å¼
- éšæœºè®¿é—®å­˜å‚¨ï¼ˆRandom Access Memory, RAM)ï¼šç°ä»£è®¡ç®—æœºæ ¹æ®åœ°å€å­˜å‚¨

ç±»æ¯”ï¼š
- LSTMè®°å¿†å•å…ƒ <-> è®¡ç®—æœºçš„å¯„å­˜å™¨
- å¤–éƒ¨è®°å¿† <-> è®¡ç®—æœºçš„å†…å­˜

ç¥ç»ç½‘ç»œå¼•å…¥å¤–éƒ¨è®°å¿†é€”å¾„ï¼š
1. ç»“æ„åŒ–è®°å¿†ï¼Œç±»ä¼¼äºè®¡ç®—æœºå­˜å‚¨ä¿¡æ¯
2. åŸºäºç¥ç»åŠ¨åŠ›å­¦çš„è”æƒ³è®°å¿†ï¼Œæœ‰æ›´å¥½çš„ç”Ÿç‰©å­¦è§£é‡Šæ€§

![3ae89e265dba855042f5db23b1f9c61a.png](/blog/_resources/8a5706990c284ab193cce496ca1f7412.png)


## 8.5 è®°å¿†å¢å¼ºç¥ç»ç½‘ç»œ
è®°å¿†å¢å¼ºç¥ç»ç½‘ç»œï¼ˆMemory Augmented Neural Networkï¼ŒMANNï¼‰ï¼šç®€ç§°ä¸ºè®°å¿†ç½‘ç»œï¼ˆMemory Networkï¼ŒMNï¼‰ï¼Œè£…å¤‡å¤–éƒ¨è®°å¿†çš„ç¥ç»ç½‘ç»œã€‚

![6aa33a6b3d8043498fd27adc794bd1b7.png](/blog/_resources/1901836e0eea40c78bcd5df784fa77c5.png)

å¤–éƒ¨è®°å¿†å°†å‚æ•°ä¸è®°å¿†å®¹é‡åˆ†ç¦»ï¼Œåœ¨å°‘é‡å¢åŠ å‚æ•°çš„æ¡ä»¶ä¸‹å¯ä»¥å¤§å¹…å¢åŠ ç½‘ç»œå®¹é‡ã€‚å› æ­¤å¯ä»¥å°†æ³¨æ„åŠ›æœºåˆ¶çœ‹ä½œä¸€ä¸ªæ¥å£ï¼Œå°†ä¿¡æ¯çš„å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»ã€‚

### 8.5.1 ç«¯åˆ°ç«¯è®°å¿†ç½‘ç»œ
ç«¯åˆ°ç«¯è®°å¿†ç½‘ç»œï¼ˆEnd-To-End Memory Networkï¼ŒMemN2Nï¼‰[Sukhbaatar et al., 2015] ï¼šå¯å¾®ç½‘ç»œç»“æ„ï¼Œå¯ä»¥å¤šæ¬¡ä»å¤–éƒ¨è®°å¿†ä¸­è¯»å–ä¿¡æ¯ï¼ˆåªè¯»ï¼‰ã€‚

ä¸»ç½‘ç»œæ ¹æ®è¾“å…¥ ğ’™ ç”Ÿæˆ ğ’’ï¼Œå¹¶ä½¿ç”¨é”®å€¼å¯¹æ³¨æ„åŠ›æœºåˆ¶æ¥ä»å¤–éƒ¨è®°å¿†ä¸­è¯»å–ç›¸å…³ä¿¡æ¯ ğ’“ï¼Œ
$$
\boldsymbol{r}=\sum\_{n=1}^{N} \operatorname{softmax}\left(\boldsymbol{a}\_{n}^{\top} \boldsymbol{q}\right) \boldsymbol{c}\_{n}
$$
å¹¶äº§ç”Ÿè¾“å‡ºï¼š
$$
y=f(q+r)
$$

å¤šè·³æ“ä½œï¼šä¸»ç½‘ç»œä¸å¤–éƒ¨è®°å¿†è¿›è¡Œå¤šè½®äº¤äº’ï¼Œæ ¹æ®ä¸Šæ¬¡è¯»å–ä¿¡æ¯ç»§ç»­æŸ¥è¯¢è¯»å–ã€‚

![202d7bb29bf23c9278407f91061d0427.png](/blog/_resources/995e0678775f4c469114e2a7aeb93079.png)

### 8.5.2 ç¥ç»å›¾çµæœº
ç¥ç»å›¾çµæœºï¼ˆNeural Turing Machineï¼ŒNTMï¼‰ï¼šç”±æ§åˆ¶å™¨å’Œå¤–éƒ¨è®°å¿†æ„æˆã€‚
- å¤–éƒ¨è®°å¿†ï¼šçŸ©é˜µ$M \in \mathbb{R}^{D \times N}$
- æ§åˆ¶å™¨ï¼šå‰é¦ˆæˆ–å¾ªç¯ç¥ç»ç½‘ç»œ

å¯»å€ï¼šåŸºäºä½ç½®ã€åŸºäºå†…å®¹

åŸºäºå†…å®¹ï¼š
![bab7e1792a4fbe0f0545387301357c22.png](/blog/_resources/794eb31a2924496b929fabd58f5010be.png)
- è¯»å‘é‡ï¼ˆread vectorï¼‰$r_t$
- åˆ é™¤å‘é‡ï¼ˆerase vectorï¼‰$e_t$
- å¢åŠ å‘é‡ï¼ˆadd vectorï¼‰$a_t$

$$
\boldsymbol{m}\_{t+1, n}=\boldsymbol{m}\_{t, n}\left(1-\alpha\_{t, n} \boldsymbol{e}\_{t}\right)+\alpha\_{t, n} \boldsymbol{a}\_{t}, \quad \forall n \in[1, N]
$$


## 8.6 åŸºäºç¥ç»åŠ¨åŠ›å­¦çš„è”æƒ³è®°å¿†
å°†åŸºäºç¥ç»åŠ¨åŠ›å­¦ï¼ˆNeurodynamicsï¼‰çš„è”æƒ³è®°å¿†æ¨¡å‹å¼•å…¥åˆ°ç¥ç»ç½‘ç»œä»¥å¢åŠ ç½‘ç»œå®¹é‡ã€‚è”æƒ³è®°å¿†æ¨¡å‹å¯ä»¥åˆ©ç”¨ç¥ç»åŠ¨åŠ›å­¦åŸç†å®ç°æŒ‰å†…å®¹å¯»å€çš„ä¿¡æ¯å­˜å‚¨å’Œæ£€ç´¢ã€‚

è”æƒ³è®°å¿†æ¨¡å‹ï¼ˆAssociative Memory Modelï¼‰ä¸»è¦æ˜¯é€šè¿‡ç¥ç»ç½‘ç»œçš„åŠ¨æ€æ¼”åŒ–æ¥è¿›è¡Œè”æƒ³ï¼Œæœ‰ä¸¤ç§åº”ç”¨åœºæ™¯ï¼š
1. è‡ªè”æƒ³æ¨¡å‹ï¼ˆAuto-Associative Modelï¼‰/è‡ªç¼–ç å™¨ï¼ˆAuto-Encoderï¼ŒAEï¼‰ï¼šè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼åœ¨åŒä¸€ç©ºé—´ã€‚
2. å¼‚è”æƒ³æ¨¡å‹ï¼ˆHetero-Associative Modelï¼‰ï¼šè¾“å…¥è¾“å‡ºæ¨¡å¼ä¸åœ¨åŒä¸€ç©ºé—´

### 8.6.1 Hopfield ç½‘ç»œ
Hopfield ç½‘ç»œï¼ˆHopfield Networkï¼‰ï¼šä¸€ç§RNNæ¨¡å‹ï¼Œç”±ä¸€ç»„ç›¸äº’è¿æ¥çš„ç¥ç»å…ƒæ„æˆã€‚æ‰€æœ‰ç¥ç»å…ƒè¿æ¥ä¸åˆ†å±‚ã€‚

![93b6af0afc093e898975074cd9ad78cc.png](/blog/_resources/bb19850f03ac4f4f9bfef51248403cdc.png)

ä¸‹é¢è®¨è®ºç¦»æ•£ Hopfield ç½‘ç»œï¼Œç¥ç»å…ƒçŠ¶æ€ä¸º {+1, âˆ’1} ä¸¤ç§ï¼Œè¿˜æœ‰è¿ç»­ Hopfield ç½‘ç»œï¼Œå³ç¥ç»å…ƒçŠ¶æ€ä¸ºè¿ç»­å€¼ã€‚

ç¬¬iä¸ªç¥ç»å…ƒæ›´æ–°è§„åˆ™ï¼š
$$
S\_{i}=\left\{\begin{array}{ll}
+1 & \text { if } \sum\_{j=1}^{M} w\_{i j} S\_{j}+b\_{i} \geq 0 \\\\
-1 & \text { otherwise }
\end{array}\right.
$$

è¿æ¥æƒé‡ $w\_{ij}$ æœ‰ä»¥ä¸‹æ€§è´¨ï¼š
$$
\begin{array}{ll}
w\_{i i} & =0 \quad \forall i \in[1, M] \\\\
w\_{i j} & =w\_{j i} \quad \forall i, j \in[1, M]
\end{array}
$$

æ›´æ–°æ–¹å¼ï¼š
- å¼‚æ­¥ï¼šæ¯æ¬¡éšæœºæˆ–è€…æŒ‰é¡ºåºæ›´æ–°ä¸€ä¸ªç¥ç»å…ƒ
- åŒæ­¥ï¼šä¸€æ¬¡æ›´æ–°æ‰€æœ‰ç¥ç»å…ƒï¼Œéœ€è¦åŒæ­¥æ—¶é’Ÿ

**èƒ½é‡å‡½æ•°**
Hopfield ç½‘ç»œçš„èƒ½é‡å‡½æ•°ï¼ˆEnergy Functionï¼‰ï¼š
$$
\begin{aligned}
E &=-\frac{1}{2} \sum\_{i, j} w\_{i j} s\_{i} s\_{j}-\sum\_{i} b\_{i} s\_{i} \\\\
&=-\frac{1}{2} \boldsymbol{s}^{\top} \boldsymbol{W} \boldsymbol{s}-\boldsymbol{b}^{\top} \boldsymbol{s}
\end{aligned}
$$

å¸å¼•ç‚¹ï¼ˆAttractorï¼‰ï¼šç¨³æ€ï¼Œèƒ½é‡çš„å±€éƒ¨æœ€ä½ç‚¹
![4671ecbbe2b44948a717ec01ac8dc9cf.png](/blog/_resources/8d58d18e599044bea061c95acd00ecd5.png)

**è”æƒ³è®°å¿†**
Hopfield ç½‘ç»œä¼šæ”¶æ•›åˆ°æ‰€å¤„ç®¡è¾–åŒºåŸŸå†…çš„å¸å¼•ç‚¹ï¼Œå°†å¸å¼•ç‚¹çœ‹ä½œç½‘ç»œå­˜å‚¨ä¸­çš„æ¨¡å¼ï¼ˆPatternï¼‰ï¼ŒHopfieldçš„æ£€ç´¢æ˜¯åŸºäºå†…å®¹å¯»å€çš„æ£€ç´¢ã€‚

**ä¿¡æ¯å­˜å‚¨**
ä¿¡æ¯å­˜å‚¨æ˜¯æŒ‡å°†ä¸€ç»„å‘é‡$x\_{1}, \cdots, x\_{N}$å­˜å‚¨åœ¨ç½‘ç»œä¸­çš„è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹ä¸»è¦æ˜¯è°ƒæ•´ç¥ç»å…ƒä¹‹é—´çš„è¿æ¥æƒé‡ï¼Œå› æ­¤å¯ä»¥çœ‹ä½œä¸€ç§å­¦ä¹ è¿‡ç¨‹ã€‚

å­¦ä¹ è§„åˆ™å¯ä»¥æ˜¯ç®€å•çš„å¹³å‡ç‚¹ç§¯ï¼š
$$
w\_{i j}=\frac{1}{N} \sum\_{n=1}^{N} x\_{i}^{(n)} x\_{j}^{(n)}
$$

èµ«å¸ƒè§„åˆ™ï¼ˆHebbian Ruleï¼Œæˆ– Hebbâ€™s Ruleï¼‰ï¼šå¸¸åŒæ—¶æ¿€æ´»çš„ç¥ç»å…ƒè¿æ¥åŠ å¼ºï¼Œåä¹‹è¿æ¥æ¶ˆå¤±ã€‚

**å­˜å‚¨å®¹é‡**
å¯¹äºæ•°é‡ä¸º $M$ çš„äº’ç›¸è¿æ¥çš„äºŒå€¼ç¥ç»å…ƒç½‘ç»œï¼Œå…¶æ€»çŠ¶æ€æ•°ä¸º $2^M$

Hopfield ç½‘ç»œçš„æœ€å¤§å®¹é‡ä¸º 0.14ğ‘€ï¼Œç»å°”å…¹æ›¼æœºçš„å®¹é‡ä¸º 0.6ğ‘€

æ”¹è¿›å­¦ä¹ ç®—æ³•ã€ç½‘ç»œç»“æ„æˆ–è€…å¼•å…¥æ›´å¤æ‚çš„è¿ç®—ï¼Œå¯ä»¥æœ‰æ•ˆæ”¹è¿›è”æƒ³è®°å¿†ç½‘ç»œçš„å®¹é‡ã€‚

### 8.6.2 ä½¿ç”¨è”æƒ³è®°å¿†å¢åŠ ç½‘ç»œå®¹é‡
å°†è”æƒ³è®°å¿†ä½œä¸ºæ›´å¤§ç½‘ç»œçš„ç»„ä»¶ï¼Œç”¨æ¥å¢åŠ çŸ­æœŸè®°å¿†çš„å®¹é‡ã€‚å‚æ•°å¯ä»¥ä½¿ç”¨Hebbianæ¥å­¦ä¹ ï¼Œæˆ–è€…ä½œä¸ºæ•´ä¸ªç½‘ç»œå‚æ•°çš„ä¸€éƒ¨åˆ†æ¥å­¦ä¹ ã€‚


## ä¹ é¢˜
#### ä¹ é¢˜ 8-1 åˆ†æ LSTM æ¨¡å‹ä¸­éšè—å±‚ç¥ç»å…ƒæ•°é‡ä¸å‚æ•°æ•°é‡ä¹‹é—´çš„å…³ç³»ï¼
![471dd2084810348f186999e4b837893d.png](/blog/_resources/97408a607c0c4569b5adf1f53585d232.png)
å‡è®¾è¾“å…¥xç»´åº¦ä¸ºnï¼Œéšå±‚ç¥ç»å…ƒæ•°ä¸ºmï¼Œå‚æ•°æ•°é‡ï¼š
- ä¸‰ä¸ªé—¨+cellæ›´æ–°ï¼š$(m+n+1)\times m\times 4$

#### ä¹ é¢˜ 8-2 åˆ†æç¼©æ”¾ç‚¹ç§¯æ¨¡å‹å¯ä»¥ç¼“è§£ Softmax å‡½æ•°æ¢¯åº¦æ¶ˆå¤±çš„åŸå› ï¼
$$
\operatorname{Attention}(Q, K, V)=\operatorname{softmax}\left(\frac{Q K^{T}}{\sqrt{d\_{k}}}\right) V
$$

å‘é‡ç‚¹ç§¯å¾€å¾€å¾ˆå¤§ï¼ŒSoftmaxå‡½æ•°åœ¨è¾“å…¥å€¼éƒ½å¾ˆå¤§å¤§çš„åŒºåŸŸä¼šå°†å…ƒç´ å·®è·æ‹‰å¾—éå¸¸å¤§ï¼Œ$\hat{y}\_{k}$æ¥è¿‘1ï¼Œæ¢¯åº¦ä¹Ÿå°±æ¥è¿‘0äº†

Scaleï¼š
$$
E\left(q\_{i} k\_{i}\right)=E q\_{i} E k\_{i}=0
$$

$$
\begin{aligned}
D\left(q\_{i} k\_{i}\right) &=E\left(q\_{i}^{2} k\_{i}^{2}\right)-\left(E\left(q\_{i} k\_{i}\right)\right)^{2} \\\\
&=E q\_{i}^{2} E k\_{i}^{2} \\\\
&=\left(D\left(q\_{i}\right)+\left(E q\_{i}\right)^{2}\right)\left(D\left(k\_{i}\right)+\left(E k\_{i}\right)^{2}\right) \\\\
&=\sigma^{4}=1
\end{aligned}
$$

$$
E\left(Q K^{T}\right)=\sum\_{i=1}^{d\_{k}} E\left(q\_{i} k\_{i}\right)=0
$$

$$
D\left(Q K^{T}\right)=\sum\_{i=1}^{d\_{k}} D\left(q\_{i} k\_{i}\right)=d\_{k} \sigma^{4}=d\_{k}
$$

ç‚¹ç§¯æœŸæœ›ä¸º0ï¼Œé€šè¿‡é™¤ä»¥æ ‡å‡†å·®ç¼©æ”¾ï¼Œç›¸å½“äºè¿›è¡Œäº†æ ‡å‡†åŒ–Standardizationï¼Œæ§åˆ¶softmaxè¾“å…¥çš„æ–¹å·®ä¸º1ï¼Œæœ‰æ•ˆè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚


#### ä¹ é¢˜ 8-3 å½“å°†è‡ªæ³¨æ„åŠ›æ¨¡å‹ä½œä¸ºä¸€ä¸ªç¥ç»å±‚ä½¿ç”¨æ—¶ï¼Œåˆ†æå®ƒå’Œå·ç§¯å±‚ä»¥åŠå¾ªç¯å±‚åœ¨å»ºæ¨¡é•¿è·ç¦»ä¾èµ–å…³ç³»çš„æ•ˆç‡å’Œè®¡ç®—å¤æ‚åº¦æ–¹é¢çš„å·®å¼‚ï¼
![b5c016b9f01702d1378a6abcbef4d44b.png](/blog/_resources/6e4ab592f48f4e4dba2d1a17f14191ce.png)
*å›¾ç‰‡æ¥æºï¼šWhy self-attention? [Tang, Gongbo, et al., 2018]*

è¿‘ä¼¼æ—¶é—´å¤æ‚åº¦ï¼š
- è‡ªæ³¨æ„åŠ›ï¼š$O(1)$
- CNNï¼š$O(\log_k(n))$
- RNNï¼š$O(n)$

![7d24d6478abcae0c2041e65d0fe030a1.png](/blog/_resources/7611df07cdf14af9b62fde51577eedff.png)
*æ¥æºï¼šcs224n, 2019, lec14*


#### ä¹ é¢˜ 8-4 è¯•è®¾è®¡ç”¨é›†åˆã€æ ‘ã€æ ˆæˆ–é˜Ÿåˆ—æ¥ç»„ç»‡å¤–éƒ¨è®°å¿†ï¼Œå¹¶åˆ†æå®ƒä»¬çš„å·®å¼‚ï¼
TODO

#### ä¹ é¢˜ 8-5 åˆ†æç«¯åˆ°ç«¯è®°å¿†ç½‘ç»œå’Œç¥ç»å›¾çµæœºå¯¹å¤–éƒ¨è®°å¿†æ“ä½œçš„å¼‚åŒç‚¹ï¼
åŒºåˆ«ï¼š
- ç«¯åˆ°ç«¯è®°å¿†ç½‘ç»œï¼šä½¿ç”¨é”®å€¼å¯¹æ³¨æ„åŠ›ä»å¤–éƒ¨è®°å¿†è¯»å–
- ç¥ç»å›¾çµæœºï¼šåŒæ—¶å¯¹æ‰€æœ‰è®°å¿†è¿›è¡Œä¸åŒç¨‹åº¦çš„è¯»å†™

#### ä¹ é¢˜ 8-6 è¯æ˜ Hopfield ç½‘ç»œçš„èƒ½é‡å‡½æ•°éšæ—¶é—´å•è°ƒé€’å‡
TODO
